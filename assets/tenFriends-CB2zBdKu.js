import{r as S,a as z,o as X,G as Y}from"./index-VxaSRTGI.js";function I(o){const C="/PocketGames/",E=new Audio(C+"/sounds/correct.wav"),T=new Audio(C+"/sounds/fail.mp3"),d=S(0),p=S(0);let i=[],n=[],l=null,u=null;function y(){return Math.floor(Math.random()*9)+1}function x(){const e=y(),t=10-e;if(t<1||t>9)return x();let a=y();for(;a===e||a===t;)a=y();const s=[];function h(){let c=0,g=0,M=!1;for(;!M;)c=Math.random()*(o.value.width-40)+20,g=-Math.random()*80,M=s.every(N=>Math.abs(N.x-c)>50);return s.push({x:c,y:g}),{x:c,y:g}}const w=h(),r=h(),f=h();i.push({x:w.x,y:w.y,value:e,selected:!1,flashColor:null},{x:r.x,y:r.y,value:t,selected:!1,flashColor:null},{x:f.x,y:f.y,value:a,selected:!1,flashColor:null})}function b(){n=[],i=[],x()}function F(){if(!o.value)return;const e=performance.now(),t=(e-A)/16.67;A=e;const a=P.value*t;for(i.forEach(s=>s.y+=a),i=i.filter(s=>s.y<o.value.height);i.length<3;)x()}function m(){if(!l||!o.value)return;const e=o.value;l.clearRect(0,0,e.width,e.height),F();for(const t of i)l&&(l.beginPath(),l.arc(t.x+20,t.y+20,20,0,Math.PI*2),l.fillStyle=t.flashColor==="green"?"rgba(0, 255, 0, 0.7)":t.flashColor==="red"?"rgba(255, 0, 0, 0.7)":t.flashColor==="yellow"?"rgba(255, 255, 0, 0.7)":"rgb(79, 208, 240)",l.fill(),l.strokeStyle="black",l.stroke(),l.fillStyle="black",l.font="16px Arial",l.fillText(t.value.toString(),t.x+19,t.y+25));l.font="20px Arial",l.textAlign="right",l.fillStyle="blue",l.fillText(`Poeng: ${d.value}`,e.width-10,30),l.textAlign="left",l.fillStyle="red",l.fillText(`Feil: ${p.value}`,10,30),u=requestAnimationFrame(m)}function G(){n.length===2&&(n[0]&&n[1]&&n[0].value+n[1].value===10?(d.value+=1,n.forEach(e=>e.flashColor="green"),E.currentTime=0,E.play(),setTimeout(()=>{i=[],n=[],b()},300)):(p.value+=1,n.forEach(e=>e.flashColor="red"),T.currentTime=0,T.play(),setTimeout(()=>{n.forEach(e=>{e.flashColor=null,e.selected=!1}),n=[]},300)))}function k(e){if(!o.value)return;const t=o.value.getBoundingClientRect(),a=o.value.width/t.width,s=o.value.height/t.height,h=(e.clientX-t.left)*a,w=(e.clientY-t.top)*s;i.forEach(r=>{const f=h-(r.x+20),c=w-(r.y+20);Math.sqrt(f*f+c*c)<=20&&!r.selected&&(r.selected=!0,r.flashColor="yellow",n.push(r),G())})}const v=()=>{if(!o.value)return;const e=window.innerWidth*.8,t=window.innerHeight*.6;o.value.width=e,o.value.height=t,m()};let A=performance.now();const P=z(()=>d.value<15?.3:d.value<25?.4:.6);X(()=>{if(!o.value)return;const e=o.value;l=e.getContext("2d"),l&&(v(),window.addEventListener("resize",v),e.addEventListener("click",k),b(),u||m())}),Y(()=>{window.removeEventListener("resize",v),o.value&&o.value.removeEventListener("click",k),u!==null&&cancelAnimationFrame(u)});function L(){u!==null&&(cancelAnimationFrame(u),u=null),window.removeEventListener("resize",v),o.value&&o.value.removeEventListener("click",k),i=[],n=[]}return{score:d,mistakes:p,startGame:b,stopGame:L,drawGame:m}}export{I as u};
